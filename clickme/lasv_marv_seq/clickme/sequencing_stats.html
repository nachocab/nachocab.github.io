<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <base target="_blank"> <!-- open all links on a new tab -->

    <title>Number of reads per sample</title>

    <link href="clickme_assets/bootstrap-tooltip.css" rel="stylesheet">
<link href="clickme_assets/clickme.css" rel="stylesheet">
<script src="clickme_assets/d3.v3.js"></script>
<script src="clickme_assets/d3_aux.js"></script>
<script src="clickme_assets/jquery.min.js"></script>
<script src="clickme_assets/bootstrap-tooltip.v2_3.js"></script>

  </head>

  <body>
    <script type="text/javascript">
    (function() {
      var clip, color_legend_counts, color_scale, color_title, data, g_color_legend, g_points, g_toggle_names, opacity, plot, point_names, points, radius, redraw, sidebar, toggle_names, toggle_points, transform;
    
      data = [{"x":["Mapped Gene"],"y":20296268,"point_name":"l3_m9_d9","virus":"marburg","lane":3,"day":9,"monkey":"M9","group":"marburg"},
{"x":["Mapped Gene"],"y":24764447,"point_name":"l3_m6_d5","virus":"marburg","lane":3,"day":5,"monkey":"M6","group":"marburg"},
{"x":["Mapped Gene"],"y":22472237,"point_name":"l3_m3_d3","virus":"marburg","lane":3,"day":3,"monkey":"M3","group":"marburg"},
{"x":["Mapped Gene"],"y":20822799,"point_name":"l3_m3_d0","virus":"marburg","lane":3,"day":0,"monkey":"M3","group":"marburg"},
{"x":["Mapped Gene"],"y":24553364,"point_name":"l2_m8_d9","virus":"marburg","lane":2,"day":9,"monkey":"M8","group":"marburg"},
{"x":["Mapped Gene"],"y":21737874,"point_name":"l2_m5_d5","virus":"marburg","lane":2,"day":5,"monkey":"M5","group":"marburg"},
{"x":["Mapped Gene"],"y":22252290,"point_name":"l2_m2_d3","virus":"marburg","lane":2,"day":3,"monkey":"M2","group":"marburg"},
{"x":["Mapped Gene"],"y":22999490,"point_name":"l2_m2_d0","virus":"marburg","lane":2,"day":0,"monkey":"M2","group":"marburg"},
{"x":["Mapped Gene"],"y":26605616,"point_name":"l1_m7_d9","virus":"marburg","lane":1,"day":9,"monkey":"M7","group":"marburg"},
{"x":["Mapped Gene"],"y":26028951,"point_name":"l1_m4_d5","virus":"marburg","lane":1,"day":5,"monkey":"M4","group":"marburg"},
{"x":["Mapped Gene"],"y":24774713,"point_name":"l1_m1_d3","virus":"marburg","lane":1,"day":3,"monkey":"M1","group":"marburg"},
{"x":["Mapped Gene"],"y":16349434,"point_name":"l1_m1_d0","virus":"marburg","lane":1,"day":0,"monkey":"M1","group":"marburg"},
{"x":["Mapped Uniquely"],"y":28845572,"point_name":"l3_d9_m9","virus":"marburg","lane":3,"day":9,"monkey":"M9","group":"marburg"},
{"x":["Mapped Uniquely"],"y":33063204,"point_name":"l3_d5_m6","virus":"marburg","lane":3,"day":5,"monkey":"M6","group":"marburg"},
{"x":["Mapped Uniquely"],"y":31297177,"point_name":"l3_d3_m3","virus":"marburg","lane":3,"day":3,"monkey":"M3","group":"marburg"},
{"x":["Mapped Uniquely"],"y":34215356,"point_name":"l3_d0_m3","virus":"marburg","lane":3,"day":0,"monkey":"M3","group":"marburg"},
{"x":["Mapped Uniquely"],"y":33024498,"point_name":"l2_d9_m8","virus":"marburg","lane":2,"day":9,"monkey":"M8","group":"marburg"},
{"x":["Mapped Uniquely"],"y":28731772,"point_name":"l2_d5_m5","virus":"marburg","lane":2,"day":5,"monkey":"M5","group":"marburg"},
{"x":["Mapped Uniquely"],"y":30534465,"point_name":"l2_d3_m2","virus":"marburg","lane":2,"day":3,"monkey":"M2","group":"marburg"},
{"x":["Mapped Uniquely"],"y":36697745,"point_name":"l2_d0_m2","virus":"marburg","lane":2,"day":0,"monkey":"M2","group":"marburg"},
{"x":["Mapped Uniquely"],"y":33749803,"point_name":"l1_d9_m7","virus":"marburg","lane":1,"day":9,"monkey":"M7","group":"marburg"},
{"x":["Mapped Uniquely"],"y":34544581,"point_name":"l1_d5_m4","virus":"marburg","lane":1,"day":5,"monkey":"M4","group":"marburg"},
{"x":["Mapped Uniquely"],"y":33793833,"point_name":"l1_d3_m1","virus":"marburg","lane":1,"day":3,"monkey":"M1","group":"marburg"},
{"x":["Mapped Uniquely"],"y":25787036,"point_name":"l1_d0_m1","virus":"marburg","lane":1,"day":0,"monkey":"M1","group":"marburg"},
{"x":["Raw"],"y":46894599,"point_name":"l3_d9_m9","virus":"marburg","lane":3,"day":9,"monkey":"M9","group":"marburg"},
{"x":["Raw"],"y":47626581,"point_name":"l3_d5_m6","virus":"marburg","lane":3,"day":5,"monkey":"M6","group":"marburg"},
{"x":["Raw"],"y":48139922,"point_name":"l3_d3_m3","virus":"marburg","lane":3,"day":3,"monkey":"M3","group":"marburg"},
{"x":["Raw"],"y":50358119,"point_name":"l3_d0_m3","virus":"marburg","lane":3,"day":0,"monkey":"M3","group":"marburg"},
{"x":["Raw"],"y":43748055,"point_name":"l2_d5_m5","virus":"marburg","lane":2,"day":5,"monkey":"M5","group":"marburg"},
{"x":["Raw"],"y":53447952,"point_name":"l2_d0_m2","virus":"marburg","lane":2,"day":0,"monkey":"M2","group":"marburg"},
{"x":["Raw"],"y":46720898,"point_name":"l2_d3_m2","virus":"marburg","lane":2,"day":3,"monkey":"M2","group":"marburg"},
{"x":["Raw"],"y":50311134,"point_name":"l2_d9_m8","virus":"marburg","lane":2,"day":9,"monkey":"M8","group":"marburg"},
{"x":["Raw"],"y":52665241,"point_name":"l1_d3_m1","virus":"marburg","lane":1,"day":3,"monkey":"M1","group":"marburg"},
{"x":["Raw"],"y":52652542,"point_name":"l1_d9_m7","virus":"marburg","lane":1,"day":9,"monkey":"M7","group":"marburg"},
{"x":["Raw"],"y":52210506,"point_name":"l1_d5_m4","virus":"marburg","lane":1,"day":5,"monkey":"M4","group":"marburg"},
{"x":["Raw"],"y":38249542,"point_name":"l1_d0_m1","virus":"marburg","lane":1,"day":0,"monkey":"M1","group":"marburg"},
{"x":["Mapped Gene"],"y":29816340,"point_name":"l3_d10_m6","virus":"lassa","lane":3,"day":10,"monkey":"L6","group":"lassa"},
{"x":["Mapped Gene"],"y":15896907,"point_name":"l3_d3_m5","virus":"lassa","lane":3,"day":3,"monkey":"L5","group":"lassa"},
{"x":["Mapped Gene"],"y":24914131,"point_name":"l3_d0_m2","virus":"lassa","lane":3,"day":0,"monkey":"L2","group":"lassa"},
{"x":["Mapped Gene"],"y":24826018,"point_name":"l3_d0_m3","virus":"lassa","lane":3,"day":0,"monkey":"L3","group":"lassa"},
{"x":["Mapped Gene"],"y":22375908,"point_name":"l2_d6_m2","virus":"lassa","lane":2,"day":6,"monkey":"L2","group":"lassa"},
{"x":["Mapped Gene"],"y":21816955,"point_name":"l2_d3_m3","virus":"lassa","lane":2,"day":3,"monkey":"L3","group":"lassa"},
{"x":["Mapped Gene"],"y":19858269,"point_name":"l2_d3_m1","virus":"lassa","lane":2,"day":3,"monkey":"L1","group":"lassa"},
{"x":["Mapped Gene"],"y":23017448,"point_name":"l2_d0_m5","virus":"lassa","lane":2,"day":0,"monkey":"L5","group":"lassa"},
{"x":["Mapped Gene"],"y":19674469,"point_name":"l1_d10_m4","virus":"lassa","lane":1,"day":10,"monkey":"L4","group":"lassa"},
{"x":["Mapped Gene"],"y":27807352,"point_name":"l1_d6_m3","virus":"lassa","lane":1,"day":6,"monkey":"L3","group":"lassa"},
{"x":["Mapped Gene"],"y":27999644,"point_name":"l1_d3_m2","virus":"lassa","lane":1,"day":3,"monkey":"L2","group":"lassa"},
{"x":["Mapped Gene"],"y":19365293,"point_name":"l1_d0_m7","virus":"lassa","lane":1,"day":0,"monkey":"L7","group":"lassa"},
{"x":["Mapped Uniquely"],"y":40388877,"point_name":"l3_d10_m6","virus":"lassa","lane":3,"day":10,"monkey":"L6","group":"lassa"},
{"x":["Mapped Uniquely"],"y":23257786,"point_name":"l3_d3_m5","virus":"lassa","lane":3,"day":3,"monkey":"L5","group":"lassa"},
{"x":["Mapped Uniquely"],"y":34393928,"point_name":"l3_d0_m3","virus":"lassa","lane":3,"day":0,"monkey":"L3","group":"lassa"},
{"x":["Mapped Uniquely"],"y":36689905,"point_name":"l3_d0_m2","virus":"lassa","lane":3,"day":0,"monkey":"L2","group":"lassa"},
{"x":["Mapped Uniquely"],"y":30801450,"point_name":"l2_d6_m2","virus":"lassa","lane":2,"day":6,"monkey":"L2","group":"lassa"},
{"x":["Mapped Uniquely"],"y":27642535,"point_name":"l2_d3_m3","virus":"lassa","lane":2,"day":3,"monkey":"L3","group":"lassa"},
{"x":["Mapped Uniquely"],"y":28325140,"point_name":"l2_d3_m1","virus":"lassa","lane":2,"day":3,"monkey":"L1","group":"lassa"},
{"x":["Mapped Uniquely"],"y":34309020,"point_name":"l2_d0_m5","virus":"lassa","lane":2,"day":0,"monkey":"L5","group":"lassa"},
{"x":["Mapped Uniquely"],"y":28568491,"point_name":"l1_d10_m4","virus":"lassa","lane":1,"day":10,"monkey":"L4","group":"lassa"},
{"x":["Mapped Uniquely"],"y":38496695,"point_name":"l1_d6_m3","virus":"lassa","lane":1,"day":6,"monkey":"L3","group":"lassa"},
{"x":["Mapped Uniquely"],"y":36043844,"point_name":"l1_d3_m2","virus":"lassa","lane":1,"day":3,"monkey":"L2","group":"lassa"},
{"x":["Mapped Uniquely"],"y":27101698,"point_name":"l1_d0_m7","virus":"lassa","lane":1,"day":0,"monkey":"L7","group":"lassa"},
{"x":["Raw"],"y":53363302,"point_name":"l3_d10_m6","virus":"lassa","lane":3,"day":10,"monkey":"L6","group":"lassa"},
{"x":["Raw"],"y":31294771,"point_name":"l3_d3_m5","virus":"lassa","lane":3,"day":3,"monkey":"L5","group":"lassa"},
{"x":["Raw"],"y":48864961,"point_name":"l3_d0_m2","virus":"lassa","lane":3,"day":0,"monkey":"L2","group":"lassa"},
{"x":["Raw"],"y":46361016,"point_name":"l3_d0_m3","virus":"lassa","lane":3,"day":0,"monkey":"L3","group":"lassa"},
{"x":["Raw"],"y":40792580,"point_name":"l2_d6_m2","virus":"lassa","lane":2,"day":6,"monkey":"L2","group":"lassa"},
{"x":["Raw"],"y":37969895,"point_name":"l2_d3_m3","virus":"lassa","lane":2,"day":3,"monkey":"L3","group":"lassa"},
{"x":["Raw"],"y":37830972,"point_name":"l2_d3_m1","virus":"lassa","lane":2,"day":3,"monkey":"L1","group":"lassa"},
{"x":["Raw"],"y":46906319,"point_name":"l2_d0_m5","virus":"lassa","lane":2,"day":0,"monkey":"L5","group":"lassa"},
{"x":["Raw"],"y":40071404,"point_name":"l1_d10_m4","virus":"lassa","lane":1,"day":10,"monkey":"L4","group":"lassa"},
{"x":["Raw"],"y":51613947,"point_name":"l1_d6_m3","virus":"lassa","lane":1,"day":6,"monkey":"L3","group":"lassa"},
{"x":["Raw"],"y":48237124,"point_name":"l1_d3_m2","virus":"lassa","lane":1,"day":3,"monkey":"L2","group":"lassa"},
{"x":["Raw"],"y":44250075,"point_name":"l1_d0_m7","virus":"lassa","lane":1,"day":0,"monkey":"L7","group":"lassa"}];
    
      radius = 5;
    
      color_scale = d3.scale.ordinal().range(["#d62728","#24A5F9"]);;
    
      opacity = null;
    
      color_title = "Virus";
    
      color_legend_counts = {"lassa":36,"marburg":36};
    
      plot = new_plot({
        width: 500,
        height: 500,
        padding: {"left":150,"top":150,"right":400,"bottom":70},
        xlab: "Stage",
        ylab: "Number of reads",
        rotate_label: {
          y: true
        },
        title: "Number of reads per sample",
        subtitle: null,
        box: false,
        xlim: null,
        ylim: null,
        data_ranges: {
          x: ["Raw","Mapped Uniquely","Mapped Gene"],
          y: [15896907,53447952]
        },
        categorical_domains: {
          x: ["Raw","Mapped Uniquely","Mapped Gene"],
          y: null
        },
        jitter: 0.2,
        hide_x_tick_labels: false,
        ordinal_scale_padding: 1,
        linear_scale_padding: 40
      });
    
      plot.tooltip_text = function(d) {
        return "<strong>" + d.point_name + "</strong>" + "<br>" + "Number of reads: " + format_property(d.y) + "<br>" + "Stage: " + format_property(d.x) + "<br>" + "virus: " + format_property(d["virus"]) + "<br>" + "lane: " + format_property(d["lane"]) + "<br>" + "day: " + format_property(d["day"]) + "<br>" + "monkey: " + format_property(d["monkey"]) + "<br>" + "group: " + format_property(d["group"]);
      };
    
      plot.center.append("defs").append("clipPath").attr("id", "clip").append("rect").attr({
        "width": plot.width,
        "height": plot.height
      });
    
      clip = plot.center.append("g").attr("clip-path", "url(#clip)");
    
      if (plot.zoom) {
        clip.append("rect").style({
          "cursor": "move"
        }).attr({
          "class": "overlay",
          "width": plot.width,
          "height": plot.height,
          "fill": "none",
          "pointer-events": "all"
        }).call(d3.behavior.zoom().x(plot.scales.x).y(plot.scales.y).scaleExtent([1, Infinity]).on("zoom", function() {
          return redraw();
        }));
        redraw = function() {
          plot.select(".x.axis").call(plot.axes.x);
          plot.select(".y.axis").call(plot.axes.y);
          return g_points.attr("transform", transform);
        };
      }
    
      transform = function(d) {
        return "translate(" + (plot.scales.x(d.x) + plot.jitters.x()) + ", " + (plot.scales.y(d.y) + plot.jitters.y()) + ")";
      };
    
      g_points = clip.selectAll(".point").data(data).enter().append("g").attr({
        "class": "point",
        "transform": transform
      });
    
      points = g_points.append("svg:circle").attr({
        "class": "point_tooltip",
        "r": radius,
        "fill": function(d) {
          return color_scale(d.group);
        },
        "opacity": function(d, i) {
          return opacity;
        },
        "title": function(d) {
          return plot.tooltip_text(d);
        }
      });
    
      $(".point_tooltip").tooltip({
        html: true,
        container: "body",
        placement: "top"
      });
    
      point_names = g_points.append("text").text(function(d) {
        return d.point_name;
      }).attr({
        "dy": ".32em",
        "dx": 8,
        "text-anchor": "left",
        "display": "none"
      }).style({
        "fill": function(d) {
          return color_scale(d.group);
        },
        "font-size": "22px"
      });
    
      if (true) {
        sidebar = plot.right_margin.append("g").attr("transform", "translate(60,0)");
        g_toggle_names = sidebar.append("g").style("cursor", "pointer").style("font-size", "22px").on("click", function() {
          return toggle_names();
        });
        g_toggle_names.append("circle").attr("r", 7).attr("stroke", "black").attr("stroke-width", 2).attr("fill", "white");
        g_toggle_names.append("text").attr('text-anchor', 'start').attr('dy', '.32em').attr('dx', '12').text("Show names (" + data.length + ")");
        toggle_names = function() {
          var showing_point_names;
          showing_point_names = g_toggle_names.classed("show_names");
          point_names.attr("display", function() {
            if (showing_point_names) {
              return "none";
            } else {
              return "inline";
            }
          });
          return g_toggle_names.attr("class", function() {
            if (showing_point_names) {
              return "";
            } else {
              return "show_names";
            }
          }).select("circle").attr("fill", function() {
            if (showing_point_names) {
              return "white";
            } else {
              return "black";
            }
          });
        };
        if (color_scale.range().length > 1) {
          sidebar.append("text").attr({
            "class": "color_title",
            "x": -radius,
            "y": 45,
            "dy": ".35em"
          }).style({
            "font-size": "16px",
            "font-weight": "bold"
          }).text(color_title);
          g_color_legend = sidebar.selectAll(".key").data(color_scale.domain().reverse()).enter().append("g").attr({
            "transform": function(d, i) {
              return "translate(0, " + (i * (radius * 2 + 15) + 70) + ")";
            },
            "class": "key"
          }).style("cursor", "pointer");
          g_color_legend.append("circle").attr({
            "r": radius,
            "fill": color_scale
          }).on("click", function(d) {
            return toggle_points(d);
          });
          g_color_legend.append("text").attr({
            "x": radius + 10,
            "y": 0,
            "dy": ".35em"
          }).text(function(d) {
            return "" + d + " (" + color_legend_counts[d] + ")";
          }).on("click", function(d) {
            return toggle_points(d);
          });
        }
      }
    
      toggle_points = function(category) {
        g_points.filter(function(d) {
          return d.group === category;
        }).classed("hide", function() {
          return !d3.select(this).classed("hide");
        });
        return g_points.filter(function(d) {
          return d.group !== category;
        }).classed("hide", false);
      };
    
    }).call(this);

    </script>
    <div class = "code">
        
    </div>
  </body>
</html>
